{% extends "base.html" %}

{% block title %}Edit Summary - {{ book.title }} - Bookshelf Flashcards{% endblock %}

{% block content %}
<div style="max-width: 800px; margin: 0 auto;">
    <div style="margin-bottom: 20px;">
        <a href="{{ url_for('view_book', book_id=book.id) }}" style="color: #667eea; text-decoration: none;">‚Üê Back to book details</a>
    </div>
    
    <h2 style="margin-bottom: 20px; color: #667eea;">Edit Summary</h2>
    
    <div style="background: white; border: 1px solid #dee2e6; border-radius: 10px; padding: 30px;">
        <h3 style="color: #667eea; margin-bottom: 10px;">{{ book.title }}</h3>
        <p style="color: #6c757d; font-style: italic; margin-bottom: 25px;">by {{ book.author }}</p>
        
        <form method="POST">
            <input type="hidden" name="action" value="save" id="form-action">
            
            <div style="margin-bottom: 20px;">
                <label for="summary" style="display: block; margin-bottom: 10px; font-weight: bold; color: #333;">Summary:</label>
                <textarea 
                    name="summary" 
                    id="summary" 
                    rows="15" 
                    style="width: 100%; padding: 12px; border: 1px solid #dee2e6; border-radius: 5px; font-family: Arial, sans-serif; font-size: 14px; resize: vertical;"
                    placeholder="Enter summary here..."
                >{{ book.summary if book.summary else '' }}</textarea>
                <p style="color: #6c757d; font-size: 0.9em; margin-top: 5px;">Maximum 10,000 characters</p>
            </div>
            
            <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                <button type="submit" class="btn" style="flex: 1;">Save Summary</button>
                
                {% if ai_available %}
                    <button 
                        type="button" 
                        class="btn" 
                        style="flex: 1; background: #ffc107; color: #000;"
                        onclick="confirmRegenerate()">
                        Regenerate with AI
                    </button>
                {% endif %}
                
                <a href="{{ url_for('view_book', book_id=book.id) }}" class="btn" style="flex: 1; text-align: center; background: #6c757d; text-decoration: none; display: inline-block; line-height: 38px;">Cancel</a>
            </div>
        </form>
    </div>
</div>

<script>
    function confirmRegenerate() {
        if (confirm('Are you sure you want to regenerate the summary? This will replace the current summary with a new AI-generated one.')) {
            document.getElementById('form-action').value = 'regenerate';
            document.querySelector('form').submit();
        }
    }
</script>
{% endblock %}
